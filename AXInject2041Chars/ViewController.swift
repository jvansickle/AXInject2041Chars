//
//  ViewController.swift
//  AXInject2041Chars
//
//  Created by John VanSickle on 8/31/20.
//  Copyright Â© 2020 John VanSickle. All rights reserved.
//

import Cocoa

class ViewController: NSViewController {

    override func viewDidLoad() {
        super.viewDidLoad()

        // Do any additional setup after loading the view.
    }

    override var representedObject: Any? {
        didSet {
        // Update the view, if already loaded.
        }
    }

    @IBAction func injectString(_ sender: Any) {
        let options = [kAXTrustedCheckOptionPrompt.takeUnretainedValue(): true] as CFDictionary
        
        if AXIsProcessTrustedWithOptions(options) {
            let systemElement = AXUIElementCreateSystemWide()
            
            var focusedElement: CFTypeRef?
            AXUIElementCopyAttributeValue(systemElement, kAXFocusedUIElementAttribute as NSString, &focusedElement)
            
            if focusedElement != nil {
                AXUIElementSetAttributeValue(focusedElement as! AXUIElement, kAXValueAttribute as NSString, chars2041)
            }
        }
    }
    
    private let chars2041 = "273065854740722166150625037298855195245082684026797633877350170641473359678357273603838805714499032597448422626402107662094830354404772769722144254213261999887431355232120448439247732137768176193632131635222110792214322810239504813704914393638900001996868288611119910784654329236479340372155666920454247870288185088048735566592883871295606724972335813446888955855720543945086329439165864033532536838021533746097292367458175925814027189984811942476285901561381610640529477984231623715442853422560369556829920248833836670311563099711122481944759198804175195266590959866737061208855552626112055837028654604807110693305382439739753318576180031940782434931331950457603815606177191091567048068944411714873036176272265022078810262403492338007904201076576957846579138262120300000239000734016208614025903038944113087021772147792299469421137332907551602077270444854959158338847864189089629541981938168838953791069895631771933836097841789972914609854260375738469148002386787065611543791019512969142780390619420273488545141793921899565608059556941300130459046554561180696679498498409855498645811101312830518811512934989454265156723681296128854049499065087517111047229412748357479357991994240947207699154257486271523885576615185145729685319666984433995480695515583700937287379948317549019926305330050078872503968629942566046337282373707242842751448628434070044733808323791861416290881891914393456184989817887055447767182974403274983887072884621403248299769482682777887858057085234297448743996551481431560304817259447455277271975090222806795398865777330450153412368732565456069104380780581676078502171459622767237953042859186339562647299673495159871070819558648861250875948667348921885095868437669685440245460857340662193079889916020928537991803910341153240201671011485704655692525121713311016701246213768752261071678347767932553548159129826494539503975655113338546190356107521098320357523707733012129546462497795607987940571576174233450782472504888717670155760955599937205094463083941301810667276868949963658705198901859172296466636082165182106461073342_" as NSString
    
}

